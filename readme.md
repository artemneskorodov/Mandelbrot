# Множество Мандельброта

## О проекте

В этом проекте проведено изучение возможностей для оптимизации кода на языках C/C++ с использованием упакованных данных в xmm/ymm регистрах. Множество Мандельброта используется как пример для сложных и долгих вычислений, которые требуют много итераций циклов.

## В проекте использовались

- Библиотека SFML для графического отображения
- Функция clock_gettime() с параметром CLOCK_PROCESS_CPUTIME_ID, который позволяет получить время работы нашего процесса
- Сайт intel intrinsics guide, который позволил находить нужные интринсики для использования

## Что должно получиться в теории

Для оптимизации использовались инструкции, позволяющие делать вычисления не для одной точки, а для 4 или 8. Теоретически это должно ускорять работу программы в ~4 и ~8 раз соотственно. Для измерения времени использовался метод наименьших квадратов. Это позволяет отбросить время которое тратится на задание констант и вызов функций. Производятся измерения зависимости времени исполнения от количества итераций, соответственно коэффициент наклона полученной прямой должен являться временем затрачиваемым на рассчёты для рендера одного экрана.

## Полученные результаты

Полученные значения приведены здесь.

Данные наносим на графики, с помощью метода наименьших квадратов можно оценить погрешность, так как её можно считать достаточно случайной.

### Без оптимизации
График зависимости времени рендеринга от количества итераций при отсутствии оптимизации:
![alt text](https://raw.githubusercontent.com/artemneskorodov/Mandelbrot/92f25651bbb628be3c7a50d1f02e83691fed3ff5/desmos-graph.png)
Время затраченное на просчёт одного кадра:
$$T_1 = (0.074956 ± 0.000099) секунд$$
### Оптимизация с данными упакованными по 4 элемента
График зависимости времени рендеринга от количества итериций при оптимизации с использованием 4-ёх упакованных элементов
![alt text](https://raw.githubusercontent.com/artemneskorodov/Mandelbrot/92f25651bbb628be3c7a50d1f02e83691fed3ff5/desmos-graph-2.png)
Время затраченное на просчёт одного кадра:
$$T_2 = (0.018268 ± 0.000020) секунд$$
### Оптимизация с данными упакованными по 8 элементов
График зависимости времени рендеринга от количества итериций при оптимизации с использованием 8-ми упакованных элементов
![alt text](https://raw.githubusercontent.com/artemneskorodov/Mandelbrot/92f25651bbb628be3c7a50d1f02e83691fed3ff5/desmos-graph-3.png)
Время затраченное на просчёт одного кадра:
$$T_3 = (0.009500 ± 0.000011) секунд$$


## Итог
Полученные отношения:
```math
\frac{T_1}{T_2} \approx 4.10
```
```math
\frac{T_1}{T_3} \approx 7.89
```
Это в пределах погрешностей измерений совпадает с примерным предсказанным результатом. Различия могут появляться из-за разных состояний системы в момент исполнения программы.


